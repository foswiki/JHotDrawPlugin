%{ Template for the page viewed while editing a drawing; uses the oops
   base because it conveniently has all the bits we need, but in fact
   the page is generated by a rest handler. }%
%TMPL:INCLUDE{"foswiki"}%
%TMPL:DEF{"pagetitle"}%%TMPL:P{"heading"}%%TMPL:END%
%TMPL:DEF{"titleaction"}% JHotDraw: %TMPL:END%
%TMPL:DEF{"heading"}% Edit <nop>JHotDraw figure '%DRAWINGNAME%' %TMPL:END%
%TMPL:DEF{"content"}%%TMPL:P{"jhotdrawmisc"}%
<applet code="CH.ifa.draw.foswiki.FoswikiDraw.class" id="mhdapp" name="mhdapp" archive="%PUBURLPATH%/%SYSTEMWEB%/JHotDrawPlugin/jhotdraw.jar" width="100%" height="75%" MAYSCRIPT>
<param name="topic" value="%WEB%.%TOPIC%" />
<param name="drawingurl" value="%ATTACHURLPATH%" />
<param name="drawingname" value="%DRAWINGNAME%" />
<param name="extracolors"  value="%WEB% background=%WEBBGCOLOR%,%FOSWIKIDRAWPLUGIN_EXTRA_COLORS%" />
<param name="saveurl" value="" />
<param name="helpurl" value="%SCRIPTURLPATH{"view"}%/%SYSTEMWEB%/JHotDrawPlugin" />
</applet>
%{ Note that this form is never submitted; the action and parameters are
   used by JS to build a XHR, using data cleaned from Java. This is to
   avoid the crap that gets thrown at us by a submit. }%
<form name="saveform" action="%SCRIPTURLPATH{"rest"}%/JHotDrawPlugin/upload" method="POST">
<input type="hidden" name="drawing" value="" />
<input type="hidden" name="exit" value="0" />
<input type="hidden" name="gif" value="" />
<input type="hidden" name="map" value="" />
<input type="hidden" name="draw" value="" />
<input type="hidden" name="topic" value="%WEB%.%TOPIC%" />
<input type="hidden" name="viewurl" value="%SCRIPTURLPATH{"view"}%/%WEB%/%TOPIC%" />
</form>
%ICON{"warning"}% You need a Java enabled browser to edit the drawing '%DRAWINGNAME%'.

%ICON{"warning"}% If you have edited this drawing before, it may be necessary to reload the drawing in the editor, due to URL caching. <br />
It may also be necessary to reload the originating topic after you have finished editing and saving this drawing, to see the updated figure.

%ICON{"key"}% It is important that you are authenticated (are logged in) while editing, otherwise your changes may be lost. <br />
%WIKITOOLNAME% currently thinks you are '<nop>%USERINFO{format="$wikiname"}%'.

%ICON{"help"}% You can get help on <nop>JHotDraw by visiting the <a target="JHotDrawPlugin" onclick="return launchWindow('%SYSTEMWEB%','JHotDrawPlugin')" href="%SCRIPTURLPATH{"view"}%/%SYSTEMWEB%/JHotDrawPlugin"><nop>JHotDrawPlugin page</a> (opens in new window).%TMPL:P{"topicinfo"}%%TMPL:END%%TMPL:END%

%TMPL:DEF{"topicactionbuttons"}%<a href="%SCRIPTURLPATH{"view"}%/%WEB%/%TOPIC%">%MAKETEXT{"Cancel"}%</a>%TMPL:END%
